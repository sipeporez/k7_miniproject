package com.subway.service;

import org.springframework.http.HttpStatus;
import org.springframework.http.HttpStatusCode;
import org.springframework.http.ResponseEntity;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import com.subway.domain.Member;
import com.subway.domain.Role;
import com.subway.persistence.MemberRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class LoginService {
	private final MemberRepository mr;
	private final PasswordEncoder enc;

	public void signup(Member m) {
		mr.save(Member.builder()
				.userid(m.getUserid())
				.password(enc.encode(m.getPassword()))
				.nickname(m.getNickname())
				.role(Role.ROLE_MEMBER)
				.build());
	}

	public ResponseEntity<?> checkID(Member m) {
		if (mr.findById(m.getUserid()).get() != null)
			return ResponseEntity.status(HttpStatus.CONFLICT);
	}

}
